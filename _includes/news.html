<div class="news">
  <h2>News</h2>
  {% if site.news %}
    <div id="news-box">
      <table class="table table-sm table-borderless mb-0">
        {% assign news = site.news | reverse %}
        {% assign news_limit = site.news_limit | default: 3 %}
        {% for item in news %}
          <tr class="news-item" data-page="{% assign page_num = forloop.index | minus: 1 | divided_by: news_limit | plus: 1 %}{{ page_num }}" {% if forloop.index > news_limit %}style="display: none;"{% endif %}>
            <td style="white-space: normal;">
              {% assign formatted_date = item.date | date: "%Y/%m/%d" %}
              {% if item.inline %}
                <strong>[{{ formatted_date }}]</strong> {{ item.content | remove: '<p>' | remove: '</p>' | emojify }}
              {% else %}
                <strong>[{{ formatted_date }}]</strong> <a class="news-title" href="{{ item.url | relative_url }}">{{ item.title }}</a>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </table>

      <div class="news-pagination">
        <button id="prev-btn" disabled>Previous page</button>

        <span id="page-info">Page 1 of <span id="total-pages"></span></span>

        <button id="next-btn">Next page</button>
      </div>
    </div>

    <script>
      const newsItems = document.querySelectorAll('.news-item');
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      const pageInfo = document.getElementById('page-info');
      const totalPagesSpan = document.getElementById('total-pages');

      const itemsPerPage = {{ site.news_limit | default: 3 }};
      const totalPages = Math.ceil(newsItems.length / itemsPerPage);
      let currentPage = 1;

      totalPagesSpan.textContent = totalPages;

      function showPage(page) {
        newsItems.forEach(item => item.style.display = 'none');

        const startIndex = (page - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;

        for (let i = startIndex; i < endIndex && i < newsItems.length; i++) {
          newsItems[i].style.display = 'table-row';
        }

        pageInfo.innerHTML = `Page ${page} of <span id="total-pages">${totalPages}</span>`;

        prevBtn.disabled = page === 1;
        nextBtn.disabled = page === totalPages;
      }

      prevBtn.addEventListener('click', () => {
        if (currentPage > 1) {
          currentPage--;
          showPage(currentPage);
        }
      });

      nextBtn.addEventListener('click', () => {
        if (currentPage < totalPages) {
          currentPage++;
          showPage(currentPage);
        }
      });

      showPage(1);
    </script>
  {% else %}
    <p>No news so far...</p>
  {% endif %}
</div>
